container AllocExports: Using = "Units", isHidden = "True"
{
	container PlanRegioResults
	{
		Unit<UInt32>  table := Invoer/SpecifiekeInstellingen/PlanRegio
		{
			attribute<string> BU_CODE                                 := Geography/RegioIndelingen/buurt/BU_CODE;
			attribute<Classifications/AanbodOptie> AanbodOptie        := EndState/AanbodOpties/PlanRegioWarmteAllocatie;

			attribute<kg_yr> CO2_gebouwen_AardGas_totaal              := indicatoren/CO2/gebouwen/AardGas/totaal;
			attribute<kg_yr> CO2_gebouwen_Elektriciteit_totaal        := indicatoren/CO2/gebouwen/Elektriciteit/totaal;
			attribute<kg_yr> CO2_gebouwen_totaal                      := indicatoren/CO2/gebouwen/totaal;
			attribute<kg_yr> CO2_totaal                               := indicatoren/CO2/totaal;
			attribute<Eur_yr> netverzwaring                           := indicatoren/netwerk/Elektriciteit/netverzwaring;

			attribute<kW> Woning_CapaciteitWarmteD                    := Initieel/KostenBaten/PlanRegioKaarten/Woning/CapaciteitWarmteD;
			attribute<nrAansl>Woning_nrAanslWarmteD                   := Initieel/KostenBaten/PlanRegioKaarten/Woning/nrAanslWarmteD;
			attribute<Float64>Woning_nrModelUnitsWarmteD              := Initieel/KostenBaten/PlanRegioKaarten/Woning/nrModelUnitsWarmteD;
			attribute<GJ_yr> Woning_VerbruikA                         := Initieel/KostenBaten/PlanRegioKaarten/Woning/VerbruikA;
			attribute<Eur_yr>Woning_WarmteVraagA                      := Initieel/KostenBaten/PlanRegioKaarten/Woning/WarmteVraagA;
			attribute<GJ_yr> Vj_WarmtePrimairD                        := Initieel/KostenBaten/Vj_WarmtePrimairD;
			attribute<GJ_yr> WarmteVraagD                             := Initieel/KostenBaten/WarmteVraagD;

			attribute<Percent> Eigendom_Koopwoningen                  := Geography/RegioIndelingen/buurt/Eigendom/p_koopw;
			attribute<Percent> Eigendom_Huurwoningen_totaal           := Geography/RegioIndelingen/buurt/Eigendom/p_huurw;
			attribute<Percent> Eigendom_In_bezit_woningcorporatie     := Geography/RegioIndelingen/buurt/Eigendom/p_wcorpw;
			attribute<Percent> Eigendom_In_bezit_overige_verhuurders  := Geography/RegioIndelingen/buurt/Eigendom/p_ov_hw;
			attribute<Percent> Eigendom_Eigendom_onbekend             := Geography/RegioIndelingen/buurt/Eigendom/p_e_o_w;
			attribute<Percent> Eigendom_p_checksum                    := Geography/RegioIndelingen/buurt/Eigendom/p_checksum;//eigen check
			attribute<Percent> Inkomen_Huishoudens_met_laag_inkomen   := Geography/RegioIndelingen/buurt/Inkomen/p_hh_li;
			attribute<Percent> Inkomen_Huishoudens_met_hoog_inkomen   := Geography/RegioIndelingen/buurt/Inkomen/p_hh_hi;
			attribute<Percent> Inkomen_Huishoudens_met_midden_inkomen := Geography/RegioIndelingen/buurt/Inkomen/p_hh_mi;//berekend veld uit andere velden
			attribute<Percent> Inkomen_p_checksum                     := Geography/RegioIndelingen/buurt/Inkomen/p_checksum;//eigen check

			attribute<GJ_yr> GebiedsOptie_totaal                      := Resultaten/J2010/indicatoren/Metervraag/gebouwen/GebiedsOptie/totaal;
			attribute<GJ_yr> Aardgas_totaal                           := Resultaten/J2010/indicatoren/Metervraag/gebouwen/Aardgas/totaal;
			attribute<GJ_yr> Elektriciteit_totaal                     := Resultaten/J2010/indicatoren/Metervraag/gebouwen/Elektriciteit/totaal;
		}

		container export := Rapportage/ExportCsvT(table, SubItem_PropValues(table,'name'), OutputFolder+'/PR.csv');
	}

	template BebouwingsComponentTempl
	{
		parameter<String> ComponentName;
		container AllocatieComponent;
		
		container BCdata     := AllocatieComponent/BCdata;
		container RuimtelijkeVraagComponent := AllocatieComponent/RuimtelijkeVraagComponent;

		Unit<UInt32>  table := AllocatieComponent/BebouwingsObject
		{
			//attribute<String> BAG_id := /Invoer/RuimtelijkeData/BAG/vbo_woonfunctie/identificatie;
			attribute<string>  id              := code;
			attribute<string>  Label           := BCdata/bebouwing/label;
			attribute<nrAansl> nrAansluitingen := RuimtelijkeVraagComponent/nrAansluitingen;

			attribute<Classifications/AanbodOptie> AanbodOptie : = AllocatieComponent/WarmteAllocatie;

			attribute<GJ_yr> MV_RW                        := AllocatieComponent/MeterVraag/RestWarmte;
			attribute<GJ_yr> MV_GT                        := AllocatieComponent/MeterVraag/GeoThermie;
			attribute<GJ_yr> MV_WKO                       := AllocatieComponent/MeterVraag/WKO;
			attribute<GJ_yr> MV_WKK                       := AllocatieComponent/MeterVraag/WijkWKK;
			attribute<GJ_yr> MV_BIOWKK                    := AllocatieComponent/MeterVraag/BioWKK;
			attribute<GJ_yr> MV_GAS                       := AllocatieComponent/MeterVraag/AardGas;
			attribute<GJ_yr> MV_ELEK                      := AllocatieComponent/MeterVraag/Elektriciteit;
			attribute<GJ_yr> MV_TOTL                      := AllocatieComponent/MeterVraag/Totaal;

			attribute<KG_yr> CO2_GAS                      := AllocatieComponent/CO2/AardGas;
			attribute<KG_yr> CO2_ELEK                     := AllocatieComponent/CO2/Elektriciteit;

			attribute<Eur> AansluitBijdrage_Gas           := AllocatieComponent/AardGas/AansluitBijdrage;
			attribute<Eur> AansluitBijdrage_Elek          := AllocatieComponent/Elektriciteit/AansluitBijdrage;
			attribute<Eur_yr> CO2Heffing_Gas              := AllocatieComponent/AardGas/CO2Heffing;
			attribute<Eur_yr> CO2Heffing_Elek             := AllocatieComponent/Elektriciteit/CO2Heffing;
			attribute<Eur_yr> Eindgebruik_ex_Gas          := AllocatieComponent/AardGas/eindgebruik_excl;
			attribute<Eur_yr> Eindgebruik_ex_Elek         := AllocatieComponent/Elektriciteit/eindgebruik_excl;
			attribute<Eur_yr> EnergieHeffing_Gas          := AllocatieComponent/AardGas/EnergieHeffing;
			attribute<Eur_yr> EnergieHeffing_Elek         := AllocatieComponent/Elektriciteit/EnergieHeffing;
			attribute<uint8> ggk_rel_Gas                  := AllocatieComponent/AardGas/ggk_rel;
			attribute<uint8> ggk_rel_Elek                 := AllocatieComponent/Elektriciteit/ggk_rel;

			attribute<Eur_yr> Maatschappelijk_Gas         := AllocatieComponent/AardGas/maatschappelijk;
			attribute<Eur_yr> Maatschappelijk_Elek        := AllocatieComponent/Elektriciteit/maatschappelijk;
			attribute<Eur_yr> Netwerk_Gas                 := AllocatieComponent/AardGas/netwerk;
			attribute<Eur_yr> Netwerk_Elek                := AllocatieComponent/Elektriciteit/netwerk;

			attribute<classifications/EnergieLabel> EL_LV := BCdata/energielabel/LastValue;
			attribute<classifications/EnergieLabel> EL_CV := BCdata/energielabel/CurrValue;
			attribute<bool> EL_WC                         := BCdata/energielabel/WasChanged;
			attribute<bool> EL_ICN                        := BCdata/energielabel/IsChangedNow;
			attribute<bool> EL_IC                         := BCdata/energielabel/IsChanged;

			attribute<m2> ZonneBoiler_m2                  := BCdata/Hoeveelheden/ZonneBoiler;
			attribute<m2> Zon_PV_m2                       := BCdata/Hoeveelheden/Zon_PV;
			attribute<nrAansl> mWKK_aantal                := BCdata/Hoeveelheden/mWKK;
			attribute<nrAansl> hWP_aantal                 := BCdata/Hoeveelheden/hWP;

			attribute<Eur> Ki_Totaal                      := BCdata/Kosten/Ki_Totaal;
			attribute<Eur> Ki_ZonneBoiler                 := BCdata/Kosten/Ki_ZonneBoiler;
			attribute<Eur> Ki_Zon_PV                      := BCdata/Kosten/Ki_Zon_PV;
			attribute<Eur> Ki_mWKK                        := BCdata/Kosten/Ki_mWKK;
			attribute<Eur> Ki_hWP                         := BCdata/Kosten/Ki_hWP;
			attribute<Eur> Ki_eWP                         := BCdata/Kosten/Ki_eWP;
			attribute<Eur> Ki_EWV                         := BCdata/Kosten/Ki_EWV;
			attribute<Eur_yr> Kj_gv_incentive             := BCdata/Kosten/Kj_gv_incentive;
		}
		container export := Rapportage/ExportCsvT(table, SubItem_PropValues(table,'name'), OutputFolder+'/'+ComponentName+'.csv');
	}

	container BebouwingsComponentResults :=
		for_each_ne(Classifications/BebouwingsComponent/name,
			'BebouwingsComponentTempl('+Quote(Classifications/BebouwingsComponent/name)+',Allocatie/'+Classifications/BebouwingsComponent/name+')');

	parameter<String> GenerateAll := 'Ready', ExplicitSuppliers = 
		"='PlanRegioResults/export/result;'"
		"+AsList('BebouwingsComponentResults/'+Classifications/BebouwingsComponent/name+'/export/result',';')";
}